






testInitPattern = [

    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
]

size_matrice = 33
pixelStart = (0, 28)



def testAlgo():
    solution_user = doExercice(testInitPattern, 2)


def resetMatrice():

    x = 0
    y = 0
    for ligne in testInitPattern:
        for pixel in ligne:

            if testInitPattern[y][x] == 1:
                testInitPattern[y][x] = 0

            x += 1

        x = 0
        y += 1








def traceKosh(finalKosh):
    for segment in finalKosh:
        for pixel in segment:
            testInitPattern [pixel[1]][pixel[0]] = 1



def doExercice(InitPattern, koshValue):

    koshSegments = []
    koshSegments.append(initKosh0(pixelStart))

    finalKosh = koskCreator(koshValue, 1, koshSegments)


    #remplissageDiffusion(InitPattern)
    resetMatrice()

    traceKosh(finalKosh)

    for ligne in testInitPattern:
        print(ligne)


    return finalKosh






def initKosh0(pixelStart):

    listPixelInitKosh0 = []

    id = 0
    y = pixelStart[1]

    while id < size_matrice:
        listPixelInitKosh0.append((id, y))
        id += 1

    return listPixelInitKosh0



def calculDistance(koshValue):
    return size_matrice / (3**(koshValue))



def splitSegment(segment, d):
    startPixelCentre = segment[0]
    endPixelCentre = segment[len(segment)-1]

    startCercle = testCercle(d, startPixelCentre)
    endCercle = testCercle(d, endPixelCentre)

    middlePixelStartCercle = None
    middlePixelEndCercle = None

    print(segment)
    print(startCercle)

    for pixel in startCercle:
        if pixel in segment:
            middlePixelStartCercle = pixel

    for pixel in endCercle:
        if pixel in segment:
            middlePixelEndCercle = pixel


    middleStartCercle = testCercle(d, middlePixelStartCercle)
    middleEndCercle = testCercle(d, middlePixelEndCercle)

    intersection = []
    middlePixel = None

    for pixel in middleStartCercle:
        if pixel in middleEndCercle:
            intersection.append(pixel)
            middlePixel = pixel

    newListSegment = []



    newListSegment.append(getLine(startPixelCentre[0],startPixelCentre[1],  middlePixelStartCercle[0], middlePixelStartCercle[1]))
    newListSegment.append(getLine(middlePixelStartCercle[0], middlePixelStartCercle[1], middlePixel[0], middlePixel[1]))
    newListSegment.append(getLine(middlePixel[0], middlePixel[1], middlePixelEndCercle[0], middlePixelEndCercle[1]))
    newListSegment.append(getLine(middlePixelEndCercle[0], middlePixelEndCercle[1], endPixelCentre[0], endPixelCentre[1]))



    return newListSegment


def koskCreator(koshValueMax, currentKoshValue, currentKosh):

    if koshValueMax - currentKoshValue < 0:
        return currentKosh

    else:
        print(currentKoshValue)
        d = calculDistance(currentKoshValue)
        print("d")
        print(d)
        print("d")

        newKosh = []
        for segment in currentKosh:

            newListSegment = splitSegment(segment, d)

            for segment in newListSegment:
                newKosh.append(segment)

      #  resetMatrice()
        traceKosh(newKosh)

     #   remplissageDiffusion(testInitPattern)

        return koskCreator(koshValueMax, currentKoshValue+1, newKosh)



def testCercle(rayon, pixelCentre):

    start_X = pixelCentre[0]
    start_Y = pixelCentre[1]
    listPixelCercle = []

    x = 0
    y = int(rayon)
    d = 5 - 4.0 * rayon

    listPixelCercle.append((x + start_X, y + start_Y))
    listPixelCercle.append((y + start_X, x + start_Y))
    listPixelCercle.append((-x + start_X, y + start_Y))
    listPixelCercle.append((-y + start_X, x + start_Y))
    listPixelCercle.append((x + start_X, -y + start_Y))
    listPixelCercle.append((y + start_X, -x + start_Y))
    listPixelCercle.append((-x + start_X, -y + start_Y))
    listPixelCercle.append((-y + start_X, -x + start_Y))

    while (y > x):

        if d > 0:
            y = y - 1
            d = d - 8.0 * y

        x = x + 1
        d = d + 8.0 * x + 4.0

        listPixelCercle.append((x + start_X, y + start_Y))
        listPixelCercle.append((y + start_X, x + start_Y))
        listPixelCercle.append((-x + start_X, y + start_Y))
        listPixelCercle.append((-y + start_X, x + start_Y))
        listPixelCercle.append((x + start_X, -y + start_Y))
        listPixelCercle.append((y + start_X, -x + start_Y))
        listPixelCercle.append((-x + start_X, -y + start_Y))
        listPixelCercle.append((-y + start_X, -x + start_Y))

    return listPixelCercle


def remplissageDiffusion(pattern):

    listPixelContent = []
    decalePixel(size_matrice-2, size_matrice-2, pattern, listPixelContent)


def decalePixel(x, y, pattern, listPixelForme):
    if x <= size_matrice - 1 and y <= size_matrice - 1 and x >= 0 and y >= 0:

        if (x, y) not in listPixelForme:

            if pattern[y][x] != 1:
                pattern[y][x] = 2
                listPixelForme.append((x, y))
                print("FLAG")

                decalePixel(x + 1, y, pattern, listPixelForme)
                decalePixel(x, y + 1, pattern, listPixelForme)
                decalePixel(x - 1, y, pattern, listPixelForme)
                decalePixel(x, y - 1, pattern, listPixelForme)



def getLine(x1, y1, x2, y2):



    res = []
    dx = x2 - x1
    if dx != 0:
        if dx > 0:
            dy = y2 - y1
            if dy != 0:

                if dy > 0:

                    if dx >= dy:
                        e = dx
                        dx = 2 * e
                        dy = dy * 2

                        if (x1,y1) not in res:
                            res.append((x1, y1))
                        while x1 != x2:
                            if (x1, y1) not in res:
                                res.append((x1, y1))

                            x1 = x1 + 1
                            e = e - dy

                            if e < 0:
                                y1 = y1 + 1
                                e = e + dx

                    else:
                        e = dy
                        dx = dx * 2
                        dy = e * 2

                        if (x1, y1) not in res:
                            res.append((x1, y1))

                        while y1 != y2:
                            if (x1, y1) not in res:
                                res.append((x1, y1))

                            y1 = y1 + 1
                            e = e - dx

                            if e < 0:
                                x1 = x1 + 1
                                e = e + dy

                else:

                    if dx >= -dy:
                        e = dx
                        dx = 2 * e
                        dy = dy * 2

                        if (x1, y1) not in res:
                            res.append((x1, y1))

                        while x1 != x2:
                            if (x1, y1) not in res:
                                res.append((x1, y1))

                            x1 = x1 + 1
                            e = e + dy

                            if e < 0:
                                y1 = y1 - 1
                                e = e + dx

                    else:
                        e = dy
                        dx = 2 * dx
                        dy = e * 2

                        if (x1, y1) not in res:
                            res.append((x1, y1))

                        while y1 != y2:
                            if (x1, y1) not in res:
                                res.append((x1, y1))

                            y1 = y1 - 1
                            e = e + dx

                            if e > 0:
                                x1 = x1 + 1
                                e = e + dy
            else:
                while x1 != x2:
                    if (x1, y1) not in res:
                        res.append((x1, y1))

                    x1 = x1 + 1


        else:

            dy = y2 - y1
            if dy != 0:

                if dy > 0:
                    if -dx >= dy:
                        # 4eme octant

                        e = dx
                        dx = 2 * e
                        dy = dy * 2

                        if (x1, y1) not in res:
                            res.append((x1, y1))

                        while x1 != x2:
                            if (x1, y1) not in res:
                                res.append((x1, y1))

                            x1 = x1 - 1
                            e = e + dy

                            if e >= 0:
                                y1 = y1 + 1
                                e = e + dx

                    else:
                        e = dy
                        dx = dx * 2
                        dy = e * 2

                        if (x1, y1) not in res:
                            res.append((x1, y1))

                        while y1 != y2:

                            if (x1, y1) not in res:
                                res.append((x1, y1))

                            y1 = y1 + 1
                            e = e + dx

                            if e <= 0:
                                x1 = x1 - 1
                                e = e + dy
                else:
                    # 5eme octant
                    if dx <= dy:
                        e = dx
                        dx = 2 * e
                        dy = dy * 2

                        if (x1, y1) not in res:
                            res.append((x1, y1))

                        while x1 != x2:
                            if (x1, y1) not in res:
                                res.append((x1, y1))

                            x1 = x1 - 1
                            e = e - dy

                            if e >= 0:
                                y1 = y1 - 1
                                e = e + dx

                    else:
                        e = dy
                        dx = 2 * dx
                        dy = e * 2

                        if (x1, y1) not in res:
                            res.append((x1, y1))

                        while y1 != y2:
                            if (x1, y1) not in res:
                                res.append((x1, y1))

                            y1 = y1 - 1
                            e = e - dx

                            if e >= 0:
                                x1 = x1 - 1
                                e = e + dy

            else:
                if (x1, y1) not in res:
                    res.append((x1, y1))

                while x1 != x2:
                    x1 = x1 - 1
                    if (x1, y1) not in res:
                        res.append((x1, y1))

    else:
        dy = y2 - y1
        if dy != 0:
            if dy > 0:
                while y1 != y2:
                    y1 = y1 + 1
                    if (x1, y1) not in res:
                        res.append((x1, y1))

            else:
                while y1 != y2:
                    y1 = y1 - 1
                    if (x1, y1) not in res:
                        res.append((x1, y1))


    return res







if __name__ == '__main__':
    testAlgo()
